// Mantid Repository : https://github.com/mantidproject/mantid
//
// Copyright &copy; 2018 ISIS Rutherford Appleton Laboratory UKRI,
//     NScD Oak Ridge National Laboratory, European Spallation Source
//     & Institut Laue - Langevin
// SPDX - License - Identifier: GPL - 3.0 +
#ifndef STRIPVANADIUMPEAKSTEST_H_
#define STRIPVANADIUMPEAKSTEST_H_

#include "MantidAPI/AnalysisDataService.h"
#include "MantidAPI/Axis.h"
#include "MantidAPI/FrameworkManager.h"
#include "MantidAlgorithms/StripVanadiumPeaks2.h"
#include "MantidDataObjects/WorkspaceCreation.h"
#include "MantidKernel/UnitFactory.h"
#include "MantidKernel/VectorHelper.h"
#include "MantidTestHelpers/WorkspaceCreationHelper.h"
#include <cxxtest/TestSuite.h>

using namespace Mantid::API;
using namespace Mantid::HistogramData;
using namespace Mantid::Kernel::VectorHelper;
using Mantid::Algorithms::StripVanadiumPeaks2;
using Mantid::MantidVec;

class StripVanadiumPeaks2Test : public CxxTest::TestSuite {
public:
  void testTheBasics() {
    StripVanadiumPeaks2 strip;
    TS_ASSERT_EQUALS(strip.name(), "StripVanadiumPeaks");
    TS_ASSERT_EQUALS(strip.version(), 2);
  }

  void testInit() {
    StripVanadiumPeaks2 strip;
    TS_ASSERT_THROWS_NOTHING(strip.initialize());
    TS_ASSERT(strip.isInitialized());
  }

  void testExec() {
    std::string inputWSName("PG3_733");
    std::string outputWSName("PG3_733_stripped");

    // Start by loading our NXS file
    IAlgorithm *loader =
        Mantid::API::FrameworkManager::Instance().createAlgorithm("LoadNexus");
    loader->setPropertyValue("Filename", "PG3_733.nxs");
    loader->setPropertyValue("OutputWorkspace", inputWSName);
    loader->execute();
    TS_ASSERT(loader->isExecuted());

    StripVanadiumPeaks2 strip;
    if (!strip.isInitialized())
      strip.initialize();

    strip.setPropertyValue("InputWorkspace", inputWSName);
    strip.setPropertyValue("OutputWorkspace", outputWSName);
    strip.setPropertyValue("BackgroundType", "Linear");
    strip.setPropertyValue("WorkspaceIndex", "2");
    strip.execute();
    TS_ASSERT(strip.isExecuted());

    MatrixWorkspace_const_sptr output;
    output = AnalysisDataService::Instance().retrieveWS<MatrixWorkspace>(
        outputWSName);

    // Get a spectrum
    MantidVec X = output->dataX(2);
    MantidVec Y = output->dataX(2);

    // Check the height at a couple of peak position
    int bin;
    bin = getBinIndex(X, 0.8113);
    TS_ASSERT_LESS_THAN(Y[bin], 11407);
    bin = getBinIndex(X, 0.8758);
    TS_ASSERT_LESS_THAN(Y[bin], 10850);

    AnalysisDataService::Instance().remove(outputWSName);
    AnalysisDataService::Instance().remove(inputWSName);
  }

  double getYValueAtX(const Histogram &histogram, const double x_value) {
    const auto &vector_x = histogram.points();
    const auto pos =
        std::lower_bound(vector_x.begin(), vector_x.end(), x_value);
    if (pos == vector_x.end())
      throw std::runtime_error("failed to find x-value");
    const auto index = (pos - vector_x.begin());
    return histogram.y()[index];
  }

  void testSharpPeaks() {
    auto PG3_40507 = createPG3_40507();

    // known positions and expected values
    const std::vector<double> PEAK_X{1.2356, 1.5133,
                                     2.1401}; // peak positions in d-spacing
    const std::vector<double> PEAK_Y{28.5, 37.8,
                                     12.3}; // low precision results of
                                            // stripped peaks
    // something is wrong with the second peak on windows
    const std::vector<double> TOL{.1, 10., .1};

    const std::string outputWSName("PG3_40507_stripped");
    StripVanadiumPeaks2 strip;
    if (!strip.isInitialized())
      strip.initialize();
    strip.setProperty("InputWorkspace", PG3_40507);
    strip.setPropertyValue("OutputWorkspace", outputWSName);
    strip.setPropertyValue("BackgroundType", "Quadratic");
    strip.setProperty("PeakPositionTolerance", 0.05);
    strip.execute();
    TS_ASSERT(strip.isExecuted());

    MatrixWorkspace_const_sptr result =
        AnalysisDataService::Instance().retrieveWS<MatrixWorkspace>(
            outputWSName);
    for (size_t i = 0; i < PEAK_X.size(); ++i) {
      const double newY = getYValueAtX(result->histogram(0), PEAK_X[i]);
      std::cout << i
                << ": orig=" << getYValueAtX(PG3_40507->histogram(0), PEAK_X[i])
                << " exp=" << PEAK_Y[i] << " obs=" << newY << std::endl;
      TS_ASSERT_DELTA(newY, PEAK_Y[i], TOL[i]);
    }

    AnalysisDataService::Instance().remove(outputWSName);
  }

private:
  /**
   * create a histogram with data hard-coded using data generated with the
   * following python script
   *
   * LoadEventAndCompress(Filename='/SNS/PG3/IPTS-2767/nexus/PG3_40507.nxs.h5',
   *  OutputWorkspace='PG3_40507', MaxChunkSize=0, FilterBadPulses=10)
   * NormaliseByCurrent(InputWorkspace='PG3_40507', OutputWorkspace='PG3_40507',
   *RecalculatePCharge=True)
   * PDLoadCharacterizations(Filename='/SNS/PG3/shared/CALIBRATION/2018_2_11A_CAL/PG3_char_2018_06_11-HighRes-PAC.txt,/SNS/PG3/shared/CALIBRATION/2018_2_11A_CAL/PG3_char_2018_05_26.txt',
   *  OutputWorkspace='characterizations', SpectrumIDs='1', L2='3.18',
   *Polar='90', Azimuthal='0')
   * PDDetermineCharacterizations(InputWorkspace='PG3_40507',
   *Characterizations='characterizations',
   *  ReductionProperties='__snspowderreduction')
   * LoadEventAndCompress(Filename='/SNS/PG3/IPTS-2767/nexus/PG3_40503.nxs.h5',
   *  OutputWorkspace='PG3_40503_loadsum', MaxChunkSize=0, FilterBadPulses=10)
   * NormaliseByCurrent(InputWorkspace='PG3_40503_loadsum',
   *OutputWorkspace='PG3_40503_loadsum', RecalculatePCharge=True)
   * RenameWorkspace(InputWorkspace='PG3_40503_loadsum',
   *OutputWorkspace='PG3_40503_vanbg')
   * Minus(LHSWorkspace='PG3_40507', RHSWorkspace='PG3_40503_vanbg',
   *OutputWorkspace='PG3_40507',
   *  ClearRHSWorkspace=True)
   * DeleteWorkspace(Workspace='PG3_40503_vanbg')
   * CompressEvents(InputWorkspace='PG3_40507', OutputWorkspace='PG3_40507',
   *Tolerance=0.01)
   * ConvertUnits(InputWorkspace='PG3_40507', OutputWorkspace='PG3_40507',
   *Target='Wavelength')
   * SetSampleMaterial(InputWorkspace='PG3_40507', ChemicalFormula='V',
   *SampleNumberDensity=0.0721)
   * CarpenterSampleCorrection(InputWorkspace='PG3_40507',
   *OutputWorkspace='PG3_40507')
   * ConvertUnits(InputWorkspace='PG3_40507', OutputWorkspace='PG3_40507',
   *Target='TOF')
   * AlignAndFocusPowder(InputWorkspace='PG3_40507',
   *OutputWorkspace='PG3_40507',
   *  CalFileName='/SNS/PG3/shared/CALIBRATION/2018_2_11A_CAL/PG3_PAC_d40481_2018_06_13.h5',
   *#GroupingWorkspace='PG3_group',
   * Params='-0.0008', RemovePromptPulseWidth=50, PrimaryFlightPath=60,
   *SpectrumIDs='1',
   *  L2='3.18', Polar='90', Azimuthal='0',
   *ReductionProperties='__snspowderreduction', PreserveEvents=False)
   *  ConvertUnits(InputWorkspace='PG3_40507', OutputWorkspace='PG3_40507',
   *Target='dSpacing')
   * RemoveLogs(Workspace='PG3_40507')
   * CropWorkspace(InputWorkspace='PG3_40507', OutputWorkspace='PG3_40507',
   *XMin=1.15, XMax=2.2)
   */
  Mantid::API::MatrixWorkspace_sptr createPG3_40507() {
    auto space2D = Mantid::DataObjects::create<
        Mantid::DataObjects::Workspace2D>(
        1,
        Histogram(
            BinEdges{1.15042999, 1.15135033, 1.15227141, 1.15319323, 1.15411578,
                     1.15503908, 1.15596311, 1.15688788, 1.15781339, 1.15873964,
                     1.15966663, 1.16059436, 1.16152284, 1.16245206, 1.16338202,
                     1.16431272, 1.16524418, 1.16617637, 1.16710931, 1.168043,
                     1.16897743, 1.16991262, 1.17084855, 1.17178522, 1.17272265,
                     1.17366083, 1.17459976, 1.17553944, 1.17647987, 1.17742105,
                     1.17836299, 1.17930568, 1.18024913, 1.18119333, 1.18213828,
                     1.18308399, 1.18403046, 1.18497768, 1.18592566, 1.1868744,
                     1.1878239,  1.18877416, 1.18972518, 1.19067696, 1.1916295,
                     1.19258281, 1.19353687, 1.1944917,  1.1954473,  1.19640366,
                     1.19736078, 1.19831867, 1.19927732, 1.20023674, 1.20119693,
                     1.20215789, 1.20311962, 1.20408211, 1.20504538, 1.20600941,
                     1.20697422, 1.2079398,  1.20890615, 1.20987328, 1.21084118,
                     1.21180985, 1.2127793,  1.21374952, 1.21472052, 1.2156923,
                     1.21666485, 1.21763818, 1.21861229, 1.21958718, 1.22056285,
                     1.2215393,  1.22251653, 1.22349455, 1.22447334, 1.22545292,
                     1.22643328, 1.22741443, 1.22839636, 1.22937908, 1.23036258,
                     1.23134687, 1.23233195, 1.23331782, 1.23430447, 1.23529191,
                     1.23628015, 1.23726917, 1.23825899, 1.23924959, 1.24024099,
                     1.24123319, 1.24222617, 1.24321995, 1.24421453, 1.2452099,
                     1.24620607, 1.24720303, 1.2482008,  1.24919936, 1.25019872,
                     1.25119888, 1.25219984, 1.2532016,  1.25420416, 1.25520752,
                     1.25621169, 1.25721665, 1.25822243, 1.25922901, 1.26023639,
                     1.26124458, 1.26225357, 1.26326338, 1.26427399, 1.26528541,
                     1.26629764, 1.26731067, 1.26832452, 1.26933918, 1.27035465,
                     1.27137094, 1.27238803, 1.27340594, 1.27442467, 1.27544421,
                     1.27646456, 1.27748574, 1.27850772, 1.27953053, 1.28055415,
                     1.2815786,  1.28260386, 1.28362994, 1.28465685, 1.28568457,
                     1.28671312, 1.28774249, 1.28877269, 1.2898037,  1.29083555,
                     1.29186821, 1.29290171, 1.29393603, 1.29497118, 1.29600716,
                     1.29704396, 1.2980816,  1.29912006, 1.30015936, 1.30119949,
                     1.30224045, 1.30328224, 1.30432486, 1.30536832, 1.30641262,
                     1.30745775, 1.30850371, 1.30955052, 1.31059816, 1.31164664,
                     1.31269595, 1.31374611, 1.31479711, 1.31584895, 1.31690162,
                     1.31795515, 1.31900951, 1.32006472, 1.32112077, 1.32217767,
                     1.32323541, 1.324294,   1.32535343, 1.32641371, 1.32747485,
                     1.32853683, 1.32959965, 1.33066333, 1.33172787, 1.33279325,
                     1.33385948, 1.33492657, 1.33599451, 1.33706331, 1.33813296,
                     1.33920346, 1.34027483, 1.34134705, 1.34242012, 1.34349406,
                     1.34456886, 1.34564451, 1.34672103, 1.3477984,  1.34887664,
                     1.34995574, 1.35103571, 1.35211654, 1.35319823, 1.35428079,
                     1.35536421, 1.3564485,  1.35753366, 1.35861969, 1.35970659,
                     1.36079435, 1.36188299, 1.36297249, 1.36406287, 1.36515412,
                     1.36624624, 1.36733924, 1.36843311, 1.36952786, 1.37062348,
                     1.37171998, 1.37281736, 1.37391561, 1.37501474, 1.37611475,
                     1.37721565, 1.37831742, 1.37942007, 1.38052361, 1.38162803,
                     1.38273333, 1.38383952, 1.38494659, 1.38605455, 1.38716339,
                     1.38827312, 1.38938374, 1.39049524, 1.39160764, 1.39272093,
                     1.3938351,  1.39495017, 1.39606613, 1.39718299, 1.39830073,
                     1.39941937, 1.40053891, 1.40165934, 1.40278067, 1.40390289,
                     1.40502601, 1.40615003, 1.40727495, 1.40840077, 1.40952749,
                     1.41065512, 1.41178364, 1.41291307, 1.4140434,  1.41517463,
                     1.41630677, 1.41743982, 1.41857377, 1.41970863, 1.4208444,
                     1.42198107, 1.42311866, 1.42425715, 1.42539656, 1.42653687,
                     1.4276781,  1.42882025, 1.4299633,  1.43110727, 1.43225216,
                     1.43339796, 1.43454468, 1.43569231, 1.43684087, 1.43799034,
                     1.43914073, 1.44029205, 1.44144428, 1.44259743, 1.44375151,
                     1.44490651, 1.44606244, 1.44721929, 1.44837706, 1.44953577,
                     1.45069539, 1.45185595, 1.45301744, 1.45417985, 1.45534319,
                     1.45650747, 1.45767267, 1.45883881, 1.46000588, 1.46117389,
                     1.46234283, 1.4635127,  1.46468351, 1.46585526, 1.46702794,
                     1.46820157, 1.46937613, 1.47055163, 1.47172807, 1.47290545,
                     1.47408378, 1.47526304, 1.47644325, 1.47762441, 1.47880651,
                     1.47998955, 1.48117354, 1.48235848, 1.48354437, 1.4847312,
                     1.48591899, 1.48710772, 1.48829741, 1.48948805, 1.49067964,
                     1.49187218, 1.49306568, 1.49426013, 1.49545554, 1.49665191,
                     1.49784923, 1.49904751, 1.50024674, 1.50144694, 1.5026481,
                     1.50385022, 1.5050533,  1.50625734, 1.50746235, 1.50866832,
                     1.50987525, 1.51108315, 1.51229202, 1.51350185, 1.51471265,
                     1.51592442, 1.51713716, 1.51835087, 1.51956555, 1.52078121,
                     1.52199783, 1.52321543, 1.524434,   1.52565355, 1.52687407,
                     1.52809557, 1.52931805, 1.5305415,  1.53176593, 1.53299135,
                     1.53421774, 1.53544511, 1.53667347, 1.53790281, 1.53913313,
                     1.54036444, 1.54159673, 1.54283001, 1.54406427, 1.54529952,
                     1.54653576, 1.54777299, 1.54901121, 1.55025042, 1.55149062,
                     1.55273181, 1.553974,   1.55521718, 1.55646135, 1.55770652,
                     1.55895268, 1.56019985, 1.56144801, 1.56269716, 1.56394732,
                     1.56519848, 1.56645064, 1.5677038,  1.56895796, 1.57021313,
                     1.5714693,  1.57272647, 1.57398466, 1.57524384, 1.57650404,
                     1.57776524, 1.57902745, 1.58029068, 1.58155491, 1.58282015,
                     1.58408641, 1.58535368, 1.58662196, 1.58789126, 1.58916157,
                     1.5904329,  1.59170525, 1.59297861, 1.59425299, 1.5955284,
                     1.59680482, 1.59808226, 1.59936073, 1.60064022, 1.60192073,
                     1.60320227, 1.60448483, 1.60576842, 1.60705303, 1.60833867,
                     1.60962534, 1.61091304, 1.61220177, 1.61349154, 1.61478233,
                     1.61607416, 1.61736701, 1.61866091, 1.61995584, 1.6212518,
                     1.6225488,  1.62384684, 1.62514592, 1.62644604, 1.62774719,
                     1.62904939, 1.63035263, 1.63165691, 1.63296224, 1.63426861,
                     1.63557602, 1.63688448, 1.63819399, 1.63950455, 1.64081615,
                     1.6421288,  1.64344251, 1.64475726, 1.64607307, 1.64738992,
                     1.64870784, 1.6500268,  1.65134682, 1.6526679,  1.65399004,
                     1.65531323, 1.65663748, 1.65796279, 1.65928916, 1.66061659,
                     1.66194508, 1.66327464, 1.66460526, 1.66593694, 1.66726969,
                     1.66860351, 1.66993839, 1.67127434, 1.67261136, 1.67394945,
                     1.67528861, 1.67662884, 1.67797014, 1.67931252, 1.68065597,
                     1.68200049, 1.6833461,  1.68469277, 1.68604053, 1.68738936,
                     1.68873927, 1.69009026, 1.69144233, 1.69279549, 1.69414972,
                     1.69550504, 1.69686145, 1.69821894, 1.69957751, 1.70093717,
                     1.70229792, 1.70365976, 1.70502269, 1.70638671, 1.70775182,
                     1.70911802, 1.71048531, 1.7118537,  1.71322318, 1.71459376,
                     1.71596544, 1.71733821, 1.71871208, 1.72008705, 1.72146312,
                     1.72284029, 1.72421856, 1.72559794, 1.72697842, 1.72836,
                     1.72974269, 1.73112648, 1.73251138, 1.73389739, 1.73528451,
                     1.73667274, 1.73806208, 1.73945252, 1.74084409, 1.74223676,
                     1.74363055, 1.74502546, 1.74642148, 1.74781861, 1.74921687,
                     1.75061624, 1.75201673, 1.75341835, 1.75482108, 1.75622494,
                     1.75762992, 1.75903602, 1.76044325, 1.76185161, 1.76326109,
                     1.7646717,  1.76608343, 1.7674963,  1.7689103,  1.77032543,
                     1.77174169, 1.77315908, 1.77457761, 1.77599727, 1.77741807,
                     1.77884,    1.78026307, 1.78168728, 1.78311263, 1.78453912,
                     1.78596676, 1.78739553, 1.78882545, 1.79025651, 1.79168871,
                     1.79312206, 1.79455656, 1.7959922,  1.797429,   1.79886694,
                     1.80030604, 1.80174628, 1.80318768, 1.80463023, 1.80607393,
                     1.80751879, 1.80896481, 1.81041198, 1.81186031, 1.8133098,
                     1.81476044, 1.81621225, 1.81766522, 1.81911935, 1.82057465,
                     1.82203111, 1.82348873, 1.82494752, 1.82640748, 1.82786861,
                     1.8293309,  1.83079437, 1.832259,   1.83372481, 1.83519179,
                     1.83665994, 1.83812927, 1.83959978, 1.84107146, 1.84254431,
                     1.84401835, 1.84549356, 1.84696996, 1.84844753, 1.84992629,
                     1.85140623, 1.85288736, 1.85436967, 1.85585316, 1.85733785,
                     1.85882372, 1.86031078, 1.86179902, 1.86328846, 1.86477909,
                     1.86627092, 1.86776393, 1.86925814, 1.87075355, 1.87225015,
                     1.87374795, 1.87524695, 1.87674715, 1.87824855, 1.87975115,
                     1.88125495, 1.88275995, 1.88426616, 1.88577357, 1.88728219,
                     1.88879202, 1.89030305, 1.89181529, 1.89332875, 1.89484341,
                     1.89635928, 1.89787637, 1.89939467, 1.90091419, 1.90243492,
                     1.90395687, 1.90548003, 1.90700442, 1.90853002, 1.91005684,
                     1.91158489, 1.91311416, 1.91464465, 1.91617636, 1.91770931,
                     1.91924347, 1.92077887, 1.92231549, 1.92385334, 1.92539243,
                     1.92693274, 1.92847429, 1.93001707, 1.93156108, 1.93310633,
                     1.93465281, 1.93620054, 1.9377495,  1.9392997,  1.94085113,
                     1.94240382, 1.94395774, 1.9455129,  1.94706932, 1.94862697,
                     1.95018587, 1.95174602, 1.95330742, 1.95487006, 1.95643396,
                     1.95799911, 1.95956551, 1.96113316, 1.96270207, 1.96427223,
                     1.96584364, 1.96741632, 1.96899025, 1.97056544, 1.9721419,
                     1.97371961, 1.97529859, 1.97687883, 1.97846033, 1.9800431,
                     1.98162713, 1.98321243, 1.984799,   1.98638684, 1.98797595,
                     1.98956633, 1.99115799, 1.99275091, 1.99434511, 1.99594059,
                     1.99753734, 1.99913537, 2.00073468, 2.00233527, 2.00393714,
                     2.00554028, 2.00714472, 2.00875043, 2.01035743, 2.01196572,
                     2.01357529, 2.01518615, 2.0167983,  2.01841174, 2.02002647,
                     2.02164249, 2.0232598,  2.02487841, 2.02649831, 2.02811951,
                     2.02974201, 2.0313658,  2.0329909,  2.03461729, 2.03624498,
                     2.03787398, 2.03950428, 2.04113588, 2.04276879, 2.044403,
                     2.04603853, 2.04767536, 2.0493135,  2.05095295, 2.05259371,
                     2.05423579, 2.05587917, 2.05752388, 2.0591699,  2.06081723,
                     2.06246589, 2.06411586, 2.06576715, 2.06741977, 2.0690737,
                     2.07072896, 2.07238554, 2.07404345, 2.07570269, 2.07736325,
                     2.07902514, 2.08068836, 2.08235291, 2.08401879, 2.08568601,
                     2.08735456, 2.08902444, 2.09069566, 2.09236822, 2.09404211,
                     2.09571734, 2.09739392, 2.09907183, 2.10075109, 2.10243169,
                     2.10411364, 2.10579693, 2.10748157, 2.10916755, 2.11085488,
                     2.11254357, 2.1142336,  2.11592499, 2.11761773, 2.11931182,
                     2.12100727, 2.12270408, 2.12440224, 2.12610176, 2.12780265,
                     2.12950489, 2.13120849, 2.13291346, 2.13461979, 2.13632749,
                     2.13803655, 2.13974698, 2.14145877, 2.14317194, 2.14488648,
                     2.14660239, 2.14831967, 2.15003833, 2.15175836, 2.15347976,
                     2.15520255, 2.15692671, 2.15865225, 2.16037917, 2.16210748,
                     2.16383716, 2.16556823, 2.16730069, 2.16903453, 2.17076975,
                     2.17250637, 2.17424437, 2.17598377, 2.17772456, 2.17946674,
                     2.18121031, 2.18295528, 2.18470164, 2.1864494,  2.18819856,
                     2.18994912, 2.19170108, 2.19345444, 2.19520921, 2.19696537,
                     2.19872295},
            Counts{18.40558623, 18.48271099, 18.58022116, 18.63815467,
                   18.88416904, 19.11337953, 19.31275093, 19.25712443,
                   19.48996464, 19.49003998, 19.79247,    19.91614535,
                   20.24544206, 20.22306103, 20.25196789, 20.38626845,
                   20.65626344, 20.74109236, 20.79413146, 20.86065954,
                   21.07537123, 21.3522932,  21.14829507, 21.3878712,
                   21.56764704, 21.85870557, 21.84459316, 21.97508027,
                   22.16162298, 22.25389579, 22.20817976, 22.57271968,
                   22.6057987,  22.5677227,  22.8126061,  22.72921862,
                   22.94680756, 23.04845773, 23.14031474, 23.14559865,
                   23.02639292, 23.33096607, 23.4234978,  23.54235628,
                   23.51312649, 23.56837853, 23.86651016, 23.87425749,
                   23.74735429, 24.04572731, 23.96657365, 24.25224136,
                   24.22355608, 24.52156268, 24.40791344, 24.53899716,
                   24.71769802, 24.63052649, 24.76844144, 25.04875965,
                   25.12726358, 25.07755356, 25.31718071, 25.31317539,
                   25.39357224, 25.43095306, 25.78129686, 25.68210396,
                   25.78057345, 25.86759487, 25.87394225, 26.02722548,
                   25.88785233, 26.18816177, 26.21837995, 26.36705335,
                   26.37847941, 26.54288738, 26.45825632, 26.76184051,
                   26.74277031, 26.87251865, 27.05732277, 27.12333233,
                   27.30151716, 27.29303278, 27.49536106, 28.10231699,
                   32.10725634, 56.33415798, 44.92901895, 32.60698747,
                   29.7205235,  29.01278894, 28.56580916, 28.45542113,
                   28.19751407, 28.55466902, 28.45410414, 28.95931474,
                   29.00030334, 28.67013509, 28.95252328, 29.10182628,
                   28.91883632, 29.20490748, 29.40339964, 29.37316913,
                   29.27985831, 29.44849083, 29.62085509, 29.56925579,
                   29.61423299, 29.91612982, 29.89046587, 30.22679661,
                   29.9901108,  30.20242124, 30.06695295, 30.30711021,
                   30.3287747,  30.31605238, 30.42851065, 30.50145415,
                   30.47503359, 30.76093774, 30.84138972, 30.75795413,
                   30.78262661, 30.90884267, 30.88194341, 31.05049799,
                   30.8834449,  30.92044119, 30.95508507, 31.14354654,
                   30.99811497, 31.05491593, 31.00981292, 31.30875227,
                   30.93133975, 31.24564607, 31.43574378, 31.23440432,
                   31.30999178, 31.52436096, 31.44778731, 31.49154166,
                   31.66148721, 31.49091975, 31.80426068, 31.84302356,
                   31.84209306, 32.0065086,  32.20203456, 32.13659061,
                   32.23219929, 32.05329088, 31.97739438, 32.09738572,
                   32.3159051,  32.49795518, 32.45706474, 32.46121061,
                   32.52952284, 32.68024485, 32.75613732, 32.86514362,
                   32.79287976, 32.76941802, 33.02628836, 32.882894,
                   32.78337512, 33.09765182, 33.17104585, 33.24573332,
                   33.53158742, 33.21390659, 33.59248098, 33.53218735,
                   33.46330454, 33.38518141, 33.47743098, 33.74606396,
                   33.62750153, 33.83520133, 33.92638281, 33.66104917,
                   33.93221313, 33.8197314,  34.04557662, 34.15748423,
                   34.12672146, 34.33890038, 33.74539265, 34.40463205,
                   34.12594973, 34.41185672, 34.37837638, 34.51301326,
                   34.39286161, 34.54583399, 34.58271127, 34.49199535,
                   34.66050016, 34.42657587, 34.6938696,  34.80669703,
                   34.60510688, 34.87904953, 34.73447998, 34.87204174,
                   34.82834831, 35.13988188, 34.9863768,  35.23200285,
                   35.09675838, 35.08191231, 34.90661505, 35.09508711,
                   34.93010592, 35.37671051, 35.16712559, 35.37387093,
                   35.35978127, 35.48069867, 35.44174442, 35.36140897,
                   35.69507503, 35.52592293, 35.46745021, 35.54150208,
                   35.58708119, 35.69113524, 35.65508331, 35.82751903,
                   35.70660167, 35.72152955, 35.68378516, 35.67824718,
                   35.76018848, 35.90198188, 35.90371283, 35.74995112,
                   35.94568605, 35.97248802, 35.83375924, 35.70617911,
                   35.87534422, 36.1167945,  35.76569122, 36.06333539,
                   36.03416411, 36.00053425, 36.0124985,  35.96321271,
                   36.07188256, 36.02871798, 35.66051415, 35.68873227,
                   35.9135806,  35.75053018, 35.69445374, 35.88842868,
                   35.88671057, 35.89964999, 35.61619517, 35.5725045,
                   35.67442507, 35.61260076, 35.47703881, 35.81085809,
                   35.63149868, 35.6702651,  35.87705872, 35.87061419,
                   35.80421674, 35.64104208, 35.69437062, 35.72692925,
                   35.72738267, 35.48594233, 35.99963505, 35.7801032,
                   36.04764904, 35.65993676, 35.89367362, 35.81002486,
                   36.06190282, 36.10484869, 35.94530052, 36.09542278,
                   35.94559347, 36.24975222, 36.08876424, 36.29043579,
                   36.34664798, 36.36258331, 36.29122811, 36.32570841,
                   36.50758454, 36.45811838, 36.43228573, 36.47003547,
                   36.58792391, 36.6040202,  36.63379879, 36.6675742,
                   36.81225434, 36.73977694, 36.65103653, 36.63847842,
                   37.05737853, 36.96377312, 36.80655137, 36.983388,
                   36.88656617, 36.97298481, 37.1293588,  36.92042691,
                   37.36916568, 37.0322241,  37.17867693, 36.91473939,
                   37.22123685, 37.21833578, 37.1726881,  37.26923654,
                   37.38705478, 37.35395051, 37.30321071, 37.06428117,
                   37.44513436, 37.17495269, 37.47842639, 37.44661909,
                   37.30936667, 37.60808724, 37.78784734, 37.57320679,
                   37.48839634, 38.79254452, 54.87364343, 70.84707536,
                   48.12842464, 40.35081375, 38.70729654, 38.06123577,
                   37.78145732, 37.87933022, 37.44479805, 37.67295734,
                   37.65568475, 37.769244,   37.62877468, 37.74903564,
                   37.85118935, 37.5053364,  37.80883332, 37.84990738,
                   37.66894039, 37.91062956, 37.69849487, 37.80595415,
                   37.68668408, 37.55324235, 37.73266576, 37.6695502,
                   37.60664493, 37.651996,   37.71062266, 37.62640642,
                   37.55553348, 37.43717072, 37.48466228, 37.41152731,
                   37.51265057, 37.28622753, 37.55559424, 37.4400787,
                   36.80313883, 37.15222524, 37.14596253, 36.90993292,
                   36.77010246, 36.68965553, 36.41491242, 36.40137937,
                   36.18288392, 36.10599388, 35.91367816, 35.5336805,
                   35.66718315, 35.22659544, 34.94622467, 34.72248219,
                   34.60309279, 34.34222926, 34.14377381, 33.48225403,
                   33.46328482, 33.26105709, 32.69151909, 32.53766043,
                   32.23242727, 31.85321021, 31.85691493, 31.3818758,
                   31.09809965, 30.88035493, 30.56073347, 30.27190289,
                   30.13640131, 29.80531002, 29.34630715, 29.33814552,
                   29.10816982, 29.0756147,  29.04132002, 28.55293389,
                   28.57824418, 28.17795127, 28.11582088, 28.0848134,
                   27.70982328, 27.66935709, 27.52545567, 27.27648389,
                   27.15679362, 27.0898298,  26.83605405, 26.62974969,
                   26.78758801, 26.51077583, 26.22087848, 26.15245061,
                   25.96861403, 26.19877064, 25.85773934, 25.80204255,
                   25.79082012, 25.4599789,  25.51328248, 25.30222652,
                   25.20114895, 25.17314203, 25.11472661, 24.7723889,
                   24.55466713, 24.38856268, 24.36097597, 24.281626,
                   24.25737974, 24.15829095, 24.00091689, 23.92001802,
                   23.9030999,  23.68240546, 23.50714926, 23.42158798,
                   23.38944111, 23.31939281, 22.94735583, 22.94058058,
                   22.6587155,  22.49923057, 22.58547309, 22.41818138,
                   22.45327799, 22.31949926, 22.16613287, 22.00546009,
                   22.22585794, 21.86567492, 21.80845515, 21.81799687,
                   21.62232314, 21.68074616, 21.49736678, 21.28302798,
                   21.34726301, 21.23466101, 21.20059407, 21.08930156,
                   21.02209296, 20.97998444, 20.99239515, 20.90467171,
                   20.7458229,  20.60948122, 20.61007477, 20.59287789,
                   20.61320497, 20.23333342, 20.07897699, 20.19540055,
                   20.08160609, 20.19251916, 20.03625102, 19.9402015,
                   19.74776945, 19.90220689, 19.71160014, 19.81127605,
                   19.71076628, 19.82091041, 19.62603469, 19.61598397,
                   19.58113306, 19.49140111, 19.3766412,  19.48476673,
                   19.36709044, 19.32114632, 19.23382273, 19.34162137,
                   19.13911317, 19.19356454, 19.12627565, 19.00186094,
                   18.98250327, 18.97639537, 18.77650772, 18.82643854,
                   18.75533369, 18.65881469, 18.71592018, 18.6780824,
                   18.71501417, 18.6822891,  18.57005076, 18.60999905,
                   18.50921102, 18.30744879, 18.53368275, 18.34841633,
                   18.44424387, 18.21504937, 18.03332596, 18.25815856,
                   17.90962482, 18.05213324, 18.20049822, 17.87504342,
                   17.94178221, 17.88965958, 17.91461492, 17.89612171,
                   17.79195299, 17.61795515, 17.81594078, 17.70649761,
                   17.53557636, 17.5116127,  17.60084224, 17.58668838,
                   17.46946547, 17.40393397, 17.39726548, 17.19669326,
                   17.337805,   17.25971871, 17.28249315, 17.14851053,
                   17.18539397, 16.96448615, 17.04025466, 16.95754606,
                   16.97508625, 16.87862255, 16.9200216,  16.78231823,
                   16.88543732, 16.89572997, 16.73870681, 16.68015,
                   16.61755237, 16.65321749, 16.66450217, 16.46221378,
                   16.62632348, 16.5543627,  16.53734613, 16.49469289,
                   16.48631236, 16.39012358, 16.41379447, 16.27629903,
                   16.21248726, 16.21349742, 16.23597912, 16.18331809,
                   16.17748432, 16.15333804, 15.95177905, 15.98550127,
                   15.9467636,  16.00851876, 15.8948976,  16.00468992,
                   15.84718798, 15.76060856, 15.83659303, 15.68937362,
                   15.81866358, 15.80012005, 15.78112302, 15.74058334,
                   15.6605951,  15.73421153, 15.62217987, 15.50400004,
                   15.60225323, 15.60573237, 15.53530882, 15.30195662,
                   15.38288134, 15.39065649, 15.45942458, 15.22643322,
                   15.27958032, 15.20623392, 15.12792131, 15.08050159,
                   15.28942881, 15.20095482, 15.14247889, 15.07858995,
                   15.01300868, 14.86515322, 14.90045879, 15.08923836,
                   14.93615638, 14.7862574,  14.89870693, 14.77827651,
                   14.68491319, 14.84061991, 14.79467833, 14.70421809,
                   14.75579789, 14.72787084, 14.52511785, 14.64743082,
                   14.53084442, 14.46501302, 14.56677532, 14.54847085,
                   14.23409342, 14.43001628, 14.37342609, 14.39348919,
                   14.29866129, 14.14962431, 14.38906367, 14.23456146,
                   14.17691161, 14.28157112, 14.14975835, 14.02357746,
                   14.04013652, 14.07181631, 13.97027177, 13.91234132,
                   13.9766018,  13.958332,   13.88728504, 13.89122306,
                   13.82904622, 13.70859823, 13.82350195, 13.68111961,
                   13.86718632, 13.71872296, 13.62476605, 13.69098933,
                   13.57134935, 13.54053325, 13.54442507, 13.64364965,
                   13.56397666, 13.39389181, 13.56399672, 13.32634941,
                   13.52350222, 13.58030948, 13.45779279, 13.27695232,
                   13.36306905, 13.36149885, 13.39542243, 13.29710606,
                   13.35070305, 13.36448393, 13.225992,   13.10584951,
                   13.22528695, 13.22306811, 13.19991708, 13.14784086,
                   13.12271078, 13.20304843, 13.27260197, 13.12099693,
                   13.07103531, 13.08507235, 13.16875447, 13.06997082,
                   13.11026661, 13.00542338, 12.95486608, 12.95761703,
                   13.07082607, 12.91886918, 12.97172813, 12.89235048,
                   12.9184118,  13.02374736, 13.04396,    12.97153352,
                   12.85787038, 13.01024647, 12.93096925, 12.91540108,
                   12.87105787, 12.93738868, 12.98088082, 13.0001405,
                   12.88411925, 12.96183709, 12.90495505, 12.91327612,
                   12.92698796, 12.88277764, 12.8336881,  12.87610752,
                   12.934943,   12.8485242,  12.6669896,  12.68266822,
                   12.70423315, 12.7829157,  12.7224095,  12.61577297,
                   12.62441151, 12.78261325, 12.5060718,  12.55499108,
                   12.67581162, 12.50316007, 12.57110062, 12.47211529,
                   12.6255669,  12.41257932, 12.56358622, 12.36888864,
                   12.31418793, 12.40379928, 12.26157892, 12.43539411,
                   12.33742294, 12.28673543, 12.12604086, 12.13448812,
                   12.22568374, 12.0663179,  12.18865647, 12.08680701,
                   12.14074906, 12.00936291, 11.99946152, 12.00482123,
                   12.08591267, 12.2607829,  13.46236265, 17.3747638,
                   21.94540318, 19.29460462, 14.70402339, 12.81319511,
                   12.13730897, 11.78222344, 11.77880739, 11.62946213,
                   11.58606309, 11.48262895, 11.4086911,  11.39529463,
                   11.40630712, 11.48762802, 11.20840128, 11.24140348,
                   11.28107765, 11.22642025, 11.22848781, 11.17324416,
                   11.04362439, 11.03457959, 11.06383906, 11.04194595,
                   11.06435942, 10.84916662, 10.91904073, 10.81549438,
                   10.95110255, 10.76351457, 10.83870247, 10.69124781,
                   10.65642081, 10.71821797},
            CountVariances{
                0.09061345, 0.09085885, 0.09084014, 0.09075258, 0.09145391,
                0.09219475, 0.09212473, 0.09233912, 0.09276106, 0.09256452,
                0.09328248, 0.0935884,  0.09421252, 0.09416478, 0.09445404,
                0.09488024, 0.0953967,  0.09529717, 0.0953829,  0.09562115,
                0.09597669, 0.09662352, 0.09629291, 0.09667691, 0.09713609,
                0.09759872, 0.09746913, 0.097789,   0.09804539, 0.09823564,
                0.09810162, 0.09865588, 0.09878608, 0.09882098, 0.09906898,
                0.098961,   0.09941916, 0.09937158, 0.09974492, 0.09981188,
                0.09983728, 0.1002573,  0.10035837, 0.10052093, 0.10077912,
                0.10055007, 0.10111611, 0.10099313, 0.10113983, 0.10152592,
                0.10155394, 0.10194169, 0.10199304, 0.10229402, 0.10232422,
                0.10218612, 0.10292982, 0.10240724, 0.1026003,  0.10312169,
                0.10346476, 0.1033123,  0.10379735, 0.10380127, 0.10398674,
                0.10431154, 0.10455596, 0.1052505,  0.10545096, 0.10514618,
                0.10611399, 0.10665123, 0.10576578, 0.10584213, 0.10560946,
                0.10596352, 0.10580093, 0.10639526, 0.10602661, 0.10661846,
                0.10647763, 0.10681167, 0.1068673,  0.10738677, 0.1076679,
                0.10763228, 0.10860019, 0.10958406, 0.11618918, 0.1483844,
                0.13412824, 0.11691087, 0.11210996, 0.11066458, 0.10979861,
                0.10958522, 0.10933175, 0.10949942, 0.10936525, 0.11022655,
                0.11057402, 0.1100942,  0.11052932, 0.11069451, 0.11057393,
                0.11086957, 0.11116207, 0.11100228, 0.11097875, 0.11133393,
                0.11165734, 0.11141227, 0.11168015, 0.11209909, 0.111912,
                0.11263736, 0.11225002, 0.11269878, 0.1122586,  0.11278133,
                0.11282309, 0.11283156, 0.11285848, 0.11322753, 0.11316201,
                0.11337442, 0.11346853, 0.1133641,  0.11362701, 0.1135896,
                0.11366064, 0.11400145, 0.11357762, 0.11370818, 0.11389959,
                0.11408176, 0.11394538, 0.11377854, 0.11395541, 0.11409542,
                0.11391721, 0.1142584,  0.11444837, 0.11416669, 0.11423569,
                0.11474726, 0.11454975, 0.11459066, 0.11492783, 0.11483853,
                0.11524056, 0.11521504, 0.11503301, 0.11554429, 0.11584337,
                0.11556254, 0.11575002, 0.11563652, 0.11542595, 0.11570801,
                0.1158586,  0.11600528, 0.11613733, 0.1161795,  0.1163012,
                0.11652074, 0.11671698, 0.11649027, 0.11670725, 0.11666918,
                0.11704312, 0.1168323,  0.11666211, 0.11713452, 0.11706081,
                0.11736878, 0.11781523, 0.11723944, 0.1177871,  0.11786421,
                0.11770941, 0.11755727, 0.11779118, 0.11801463, 0.11798372,
                0.11835702, 0.11820464, 0.11794876, 0.11833424, 0.11825397,
                0.11853825, 0.11868084, 0.11857568, 0.11890506, 0.11834615,
                0.11887005, 0.11868061, 0.11900734, 0.11890801, 0.11928773,
                0.11933879, 0.11950798, 0.11935514, 0.11928139, 0.11935545,
                0.11915067, 0.11939353, 0.11956198, 0.1193625,  0.11961223,
                0.11956111, 0.1197357,  0.11963851, 0.11997262, 0.11983564,
                0.12003922, 0.11995384, 0.11983126, 0.11978,    0.11990461,
                0.11990151, 0.1205824,  0.12024106, 0.12043872, 0.12046799,
                0.12051577, 0.12047459, 0.12049854, 0.12087799, 0.12044014,
                0.12031675, 0.12044389, 0.12083971, 0.12083157, 0.12082134,
                0.12115007, 0.12069022, 0.12083268, 0.12069638, 0.12074078,
                0.12092253, 0.12096648, 0.1209408,  0.12083527, 0.12095569,
                0.12098025, 0.12076102, 0.12086163, 0.12094667, 0.12139388,
                0.12078216, 0.12103414, 0.12126756, 0.12120854, 0.12108292,
                0.12100308, 0.12115043, 0.12121332, 0.1206329,  0.12090712,
                0.12076863, 0.12074094, 0.12062303, 0.12082079, 0.1209909,
                0.12112458, 0.12207246, 0.12218142, 0.12154999, 0.12233238,
                0.12345171, 0.12216962, 0.1210342,  0.12071547, 0.12082515,
                0.12078011, 0.12059255, 0.12013529, 0.1204411,  0.12030222,
                0.12064879, 0.12008365, 0.12085759, 0.12055658, 0.12091152,
                0.12039997, 0.12068333, 0.12073999, 0.12102517, 0.12096843,
                0.12068165, 0.12119209, 0.12092863, 0.12131486, 0.12109464,
                0.1214653,  0.12136762, 0.12149701, 0.12139231, 0.12154187,
                0.12189975, 0.12173327, 0.12165145, 0.121803,   0.12168023,
                0.12177848, 0.12195502, 0.12209618, 0.12208228, 0.122006,
                0.12213498, 0.12195088, 0.12257762, 0.12234055, 0.1221249,
                0.12234262, 0.12240725, 0.12253272, 0.12251793, 0.1224379,
                0.12299764, 0.12256128, 0.12286631, 0.12255145, 0.1227136,
                0.12275076, 0.12261058, 0.12281186, 0.1230996,  0.12306993,
                0.12278627, 0.12287486, 0.12310438, 0.12269442, 0.12314675,
                0.12307819, 0.12295634, 0.12333423, 0.12371617, 0.12356086,
                0.12396455, 0.12659848, 0.14758044, 0.16541888, 0.13957303,
                0.12925304, 0.12604731, 0.12459023, 0.12378261, 0.12370793,
                0.12335084, 0.12343917, 0.12326433, 0.12357662, 0.12350549,
                0.12364156, 0.12359094, 0.12328373, 0.12366544, 0.1234665,
                0.12353506, 0.12369789, 0.12331939, 0.12348493, 0.12342986,
                0.12325508, 0.12352657, 0.12337392, 0.12310312, 0.12319982,
                0.12338479, 0.12319994, 0.1229019,  0.12291918, 0.12285192,
                0.12263437, 0.12259662, 0.1223905,  0.1227991,  0.12251541,
                0.12171606, 0.12204615, 0.1217534,  0.12143749, 0.12109563,
                0.12083896, 0.12050626, 0.12020373, 0.11972535, 0.1196556,
                0.11901792, 0.11829378, 0.11842445, 0.11765844, 0.11712006,
                0.11653108, 0.11603167, 0.11568374, 0.1150576,  0.11385368,
                0.11350685, 0.11312784, 0.11194691, 0.11169322, 0.11102328,
                0.11043224, 0.10997193, 0.10913658, 0.10857883, 0.10804441,
                0.10736598, 0.10689977, 0.10632894, 0.10583985, 0.10511315,
                0.10488256, 0.10440227, 0.10436692, 0.10409351, 0.10326387,
                0.10327201, 0.10251131, 0.10227501, 0.10223691, 0.10140431,
                0.10134056, 0.10106912, 0.10048082, 0.10015192, 0.10000476,
                0.09940061, 0.09911605, 0.09937981, 0.09889048, 0.09833957,
                0.09809914, 0.09770799, 0.09799267, 0.09749047, 0.0973443,
                0.09721181, 0.09660111, 0.09670059, 0.09632986, 0.09588216,
                0.09600354, 0.09579305, 0.09517147, 0.09475963, 0.09434851,
                0.09436208, 0.0941166,  0.09412621, 0.09389304, 0.09362614,
                0.0934498,  0.09337322, 0.0930348,  0.09255238, 0.09246405,
                0.09239633, 0.09228948, 0.09149797, 0.09150998, 0.09091079,
                0.09059358, 0.09073656, 0.09044675, 0.09052901, 0.09021704,
                0.08983709, 0.08971085, 0.09012132, 0.08936779, 0.08918196,
                0.08916877, 0.08892073, 0.08893757, 0.08858692, 0.0881193,
                0.08828271, 0.0879663,  0.08785613, 0.08774057, 0.08761425,
                0.08746617, 0.08754376, 0.08727514, 0.08697893, 0.08661758,
                0.08678746, 0.08670468, 0.08679087, 0.08602114, 0.08557962,
                0.08594464, 0.08552812, 0.08579972, 0.08549704, 0.08537773,
                0.08484182, 0.08527655, 0.08476341, 0.08501413, 0.08480269,
                0.08501053, 0.08471737, 0.08458685, 0.08452883, 0.08437682,
                0.08400888, 0.0843093,  0.08404998, 0.08403721, 0.08372893,
                0.08403811, 0.08353716, 0.08367217, 0.08358381, 0.08323296,
                0.08324134, 0.08313687, 0.0827609,  0.08286916, 0.08265502,
                0.08251579, 0.08257177, 0.08254709, 0.08265035, 0.08260576,
                0.08239178, 0.08240309, 0.08219041, 0.0817003,  0.08219778,
                0.08173714, 0.08195537, 0.0815065,  0.08111007, 0.0816751,
                0.08086731, 0.08124781, 0.08148713, 0.08082474, 0.08086508,
                0.08082352, 0.08084213, 0.08086525, 0.08057361, 0.08014514,
                0.08049376, 0.08034359, 0.07998387, 0.07990817, 0.08010026,
                0.08001849, 0.07982477, 0.07970619, 0.07961312, 0.07913916,
                0.07960793, 0.07928162, 0.07931951, 0.07911895, 0.07924796,
                0.07861915, 0.078851,   0.07869252, 0.07873411, 0.07844709,
                0.07851855, 0.07822954, 0.07848927, 0.07842583, 0.07811262,
                0.07796776, 0.07790764, 0.07785552, 0.07794405, 0.07750911,
                0.07786925, 0.07754503, 0.07765547, 0.07757437, 0.07760141,
                0.07724084, 0.07721791, 0.07704123, 0.07685608, 0.0769753,
                0.07688559, 0.07670552, 0.07670128, 0.07666367, 0.07615797,
                0.0763716,  0.07625804, 0.07633819, 0.0760897,  0.07643624,
                0.0760088,  0.07576586, 0.07612283, 0.07564781, 0.07591185,
                0.07588707, 0.07589227, 0.07575599, 0.0755274,  0.07583084,
                0.07548325, 0.07523937, 0.07541937, 0.07533061, 0.07522039,
                0.07464627, 0.0749228,  0.07483709, 0.07499167, 0.07449394,
                0.07464648, 0.07453324, 0.07423873, 0.07419753, 0.07467062,
                0.07449603, 0.07424625, 0.07415208, 0.07395542, 0.07366103,
                0.07372235, 0.07414122, 0.07381445, 0.07341285, 0.07370479,
                0.07343342, 0.07317712, 0.07357358, 0.07350074, 0.07323104,
                0.07320646, 0.07334826, 0.07278856, 0.07311356, 0.07289351,
                0.07258756, 0.07299891, 0.07276867, 0.07213024, 0.07252438,
                0.07234726, 0.07247819, 0.07223626, 0.07188469, 0.07236707,
                0.07214867, 0.07183589, 0.07216702, 0.07176504, 0.07154792,
                0.0714893,  0.07168797, 0.07142927, 0.07117226, 0.07138552,
                0.07148576, 0.07125145, 0.07116823, 0.07113642, 0.07089822,
                0.07095803, 0.07067905, 0.07122147, 0.07080627, 0.07045241,
                0.07064644, 0.07045675, 0.07023966, 0.0702617,  0.07061058,
                0.07033734, 0.06987954, 0.07041236, 0.06974364, 0.07027269,
                0.07036899, 0.07015203, 0.06978766, 0.06985847, 0.06978652,
                0.06992062, 0.06967079, 0.06980092, 0.06984545, 0.06946438,
                0.0692113,  0.06947494, 0.06954763, 0.06937168, 0.06917832,
                0.06922749, 0.06949966, 0.06966824, 0.06924553, 0.06909893,
                0.06914696, 0.06924436, 0.06909882, 0.06917435, 0.06883593,
                0.06868457, 0.06879058, 0.06897344, 0.06878056, 0.06893278,
                0.06863372, 0.0686559,  0.06896215, 0.0689892,  0.06877229,
                0.06850599, 0.06897721, 0.0686959,  0.06878704, 0.06861183,
                0.0687965,  0.06880388, 0.06888769, 0.06871961, 0.06868365,
                0.06855779, 0.06852955, 0.06859698, 0.06854567, 0.06835265,
                0.06848645, 0.06857056, 0.06841071, 0.06798028, 0.06802586,
                0.06799168, 0.06815501, 0.06814112, 0.06790047, 0.0678429,
                0.06831629, 0.06761858, 0.06764785, 0.06798609, 0.0675935,
                0.06775755, 0.06749517, 0.06791124, 0.0673451,  0.06777571,
                0.06721334, 0.06713083, 0.06721366, 0.06692459, 0.06728881,
                0.06705009, 0.06716039, 0.06658561, 0.06660794, 0.0668228,
                0.06639459, 0.06664136, 0.06640293, 0.06659663, 0.06617972,
                0.06630982, 0.06628822, 0.06644162, 0.06691039, 0.06988695,
                0.07920677, 0.08874079, 0.08334671, 0.07295063, 0.06833664,
                0.06653433, 0.06566708, 0.06555435, 0.06527518, 0.06513995,
                0.06482874, 0.06460965, 0.06463104, 0.06463471, 0.06481889,
                0.06410483, 0.06412912, 0.06425102, 0.06407212, 0.06416003,
                0.06395273, 0.06363819, 0.0635063,  0.06364338, 0.06362024,
                0.06357006, 0.06292629, 0.06319382, 0.06293484, 0.06333936,
                0.06281112, 0.06287284, 0.06251089, 0.06240202, 0.06257857}));
    space2D->getAxis(0)->unit() =
        Mantid::Kernel::UnitFactory::Instance().create("dSpacing");
    return std::move(space2D);
  }
};

#endif /*STRIPVANADIUMPEAKSTEST_H_*/
