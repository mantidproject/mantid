#ifndef MANTIDQTCUSTOMINTERFACES_DYNAMICPDF_SLICESELECTOR_H_
#define MANTIDQTCUSTOMINTERFACES_DYNAMICPDF_SLICESELECTOR_H_

#include "MantidQtCustomInterfaces/DllConfig.h"
#include "MantidQtAPI/UserSubWindow.h"
#include "ui_SliceSelector.h"

namespace MantidQt {
namespace CustomInterfaces {
namespace DynamicPDF {

using workspacePtr = boost::shared_ptr<Mantid::API::MatrixWorkspace>;

// Forward Declarations
class BackgroundRemover;

/// Helper class containing pointer and some metadata for the loaded workspace
class WorkspaceRecord{

public:
  /// Default Constructor
  WorkspaceRecord(const std::string &workspaceName);
  void updateMetadata(const size_t &newIndex);

  workspacePtr ws;
  const std::string name;
  double energy;
  std::string label;
};


class MANTIDQT_CUSTOMINTERFACES_DLL SliceSelector
    : public MantidQt::API::UserSubWindow {
  Q_OBJECT

public:
  /// The name of the interface as registered into the factory
  static std::string name() { return "Dynamic PDF Slice Selector"; }
  // This interface's categories.
  static QString categoryInfo() { return "DynamicPDF"; }

public:
  /// Default Constructor
  SliceSelector(QWidget *parent = NULL);

private slots:
  /// Opens the Qt help page for the interface
  void showHelp();
  /// Load file or workspace containing energy slices
  void loadedSlices(const QString &workspaceName);
  /// Update all child widgets
  void updateSelectedSlice(const int &newSelectedIndex);
  void updatePlotSelectedSlice();
  /// Launch (initialize and/or update) the background removal tool
  void launchBackgroundRemover();

private:
  /// Initialize the ui form and connect SIGNALS to SLOTS
  void initLayout();
  /// The form generated by Qt Designer
  Ui::SliceSelector m_uiForm;
  boost::shared_ptr<WorkspaceRecord> m_loadedWorkspace;
  size_t m_selectedWorkspaceIndex;
  /// The child dialog to remove the multiphonon background
  boost::shared_ptr<BackgroundRemover> m_BackgroundRemover;
};

}
}
}
#endif // MANTIDQTCUSTOMINTERFACES_DYNAMICPDF_SLICESELECTOR_H_
