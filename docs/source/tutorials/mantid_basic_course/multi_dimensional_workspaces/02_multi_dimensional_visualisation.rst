.. _02_multi_dimensional_visualisation:

================================
 Multi Dimensional Visualisation 
================================

Creating Your Data
==================

The next section requires a dataset that is faster to create than Load.

#. Click the View -> Script window menu.
#. In the script window click File->Open, and open the file
   "C:\MantidInstall\data\CreateSXDNaClQLab.py"
#. Click the Execute -> Execute All menu.
#. After about 30 seconds you should have a SXDNaClQLab workspace.

**Note to Demonstrators:** You may want to do this during the preceding
exercise.

SliceViewer
===========

|sliceviewer.png|

The `Slice Viewer <https://www.mantidproject.org/MantidPlot:_SliceViewer>`_ provides 2D slices through
MDWorkspaces. It is designed to provide very fast, interactive
projections on large datasets. The SliceViewer is also furnished with
a number of 2D tools to aid further visualisation and analysis.

Features include:

-  `Line Viewer <https://www.mantidproject.org/MantidPlot:_LineViewer>`_ for creating arbitrary 1D integrated cuts
   as separate workspaces
-  `Peaks Viewer <https://www.mantidproject.org/PeaksViewer>`_ for over-plotting one or more
   :ref:`PeaksWorkspace` in the Q coordinate frame
-  Control via python `Slice Viewer Python Interface <https://www.mantidproject.org/SliceViewer_Python_Interface>`_
-  In-situ rebinning according to slice location
-  Zooming and panning control

Introduction to Feature Controls
--------------------------------

From the image above

Dimension Selection (1)
~~~~~~~~~~~~~~~~~~~~~~~

Allows you to choose which dimensions in the workspace are to be plotted
X and Y on the plot. All other dimensions are provided as sliders. Each
dimension has an **X** button and a **Y** button. Selecting one of these
will make this dimension either the X or Y of the plot.

Slice Point Selection (2)
~~~~~~~~~~~~~~~~~~~~~~~~~

Sliders allow you to choose the slice location. The plot will
immediately update to show a projection at the new slice location. N-2
dimensions are represented with sliders.

Line Integration Mode (3)
~~~~~~~~~~~~~~~~~~~~~~~~~

|LineViewer.png| 

Selecting this
button will allow you to draw a line on the current slice. This will
also open the *LineViewer* panel. The line can be controlled in the
following ways:

-  Start and end positions
-  Width in plane
-  Thickness (into plane)
-  Number of bins

The controls may be updated either graphically, for example by grabbing
the start position point and moving it with the left-click mouse option,
or by updating the coordinates in the *LineViewer* panel.

Hitting the *Apply* button results in the generation of a new
Workspace which is one-dimensional.

Dynamic Rebinning (4)
~~~~~~~~~~~~~~~~~~~~~

The slice viewer allows you to interactively rebin the currently viewed
slice to a regular grid. This will also result in the generation of a
new rebinned workspace in Mantid. The icon labeled 4a has to be pressed
first to alow rebinning. 4c automatically rebins the current view.
The upper image below is before rebinning, the lower image is after rebinning.

.. figure:: /images/RebinOff.png 
   :alt: RebinOff.png    
   :width: 400px         

.. figure:: /images/RebinOn.png   
   :alt: RebinOn.png      
   :width: 400px          

Peaks Viewer (5)
~~~~~~~~~~~~~~~~

| |Peaks_view_outline_unannotated.png|
| The *PeaksViewer* is a tool for Single Crystal Diffraction. It allows
  you to overlay one or more PeaksWorkspaces over the MDWorkspace to
  which it belongs. PeaksWorkspaces are typically generated by running
  algorithms, such as :ref:`FindPeaksMD`.

-  Slice through the MDWorkspace and the PeaksWorkspaces simultaneously
   in the SliceViewer plot
-  Select peaks from the peaks list in the PeaksViewer, and cause the
   SliceViewer to zoom into that exact location on the plot
-  Show integration regions and optionally integration background
   regions
-  PeaksViewer auto selects the coordinates frame for the
   PeaksWorkspaces based on the MDWorkspace
-  Sort the PeaksWorkspaces in-situ, for example by greatest intensity

Amongst other usages, this tool therefore allows you to inspect the
quality of the peak finding, or peak integration operations.

Example
-------

#. Run **Load** on the MDWorkspace file *SXDNaClQLab.nxs*
#. Run **Load** on the PeaksWorkspace file *peaks_qLab.nxs*
#. Right click the MDWorkspace and select *Show Slice Viewer* option
#. Use the Slider to slice through the Qz dimension
#. Open the LineViewer and draw a line

Vates Simple Interface
======================

|ReleasePic.png| 

The `Vates Simple Interface <https://www.mantidproject.org/VatesSimpleInterface_v2>`_, or VSI provides full-blown 4D
visualisation capabilities. The VSI uses ParaView as the visualisation
engine.

Examples
========

Example 1
---------

#. Run **Load** on the MDWorkspace file *SXDNaClQLab.nxs*
#. Right click the MDWorkspace and select *Show Vates Simple Interface*.
   The VSI should open showing a 3D representation of the MDWorkspace
   |MantidPlot_VSI-v2_Menu.png|
#. Click the **Rebin** button above the plot area
#. On the properties panel change the number of **Bins** property to 100
   for each dimension click the **Apply** button. The Workspace should
   now be rebinned to a regular 100*100*100 Grid

.. figure:: /images/MBC_VSI_Example1.png
   :alt: MBC_VSI_Example1.png
   :width: 400px

Example 2
---------

#. Complete Example 1 if you haven't already and leave the VSI open
#. On the top menu select the '''MultiSlice '''
   |VSI-MultisliceButton.png| mode
#. The view should be empty. Cuts can be added by double-clicking on an
   axis scale between the axis scale line and the view area to place an
   indicator at that point and this adds the slice on the 3D view. Add a
   few cuts
#. Move the cut slice positions along the axis and observe the surface
   projections updating

.. figure:: /images/MBC_VSI_Example2.png
   :alt: MBC_VSI_Example2.png
   :width: 400px

Example 3
---------

#. Follow steps 1-2 from Example 1.
#. On the top menu select the **ScatterPlot**
   |VSI-SplatterPlotButton.png| mode
#. Set the **Top Percentile** option on the Properties Tab to be *0.05*
#. Click *'Use Log Scale* at the top of the plot area
#. Without closing the VSI load the file **peaks_qLab.nxs** into
   MantidPlot, which produces a PeaksWorkspace.
#. Load the PeaksWorkspace into the VSI, by right-clicking the workspace
   and selecting *Show Vates Simple Interface*. You should now see peak
   positions as cross-hairs overlayed over the original MDWorkspace
   data.

.. figure:: /images/MBC_VSI_Example3.png
   :alt: MBC_VSI_Example3.png
   :width: 400px

.. raw:: mediawiki

   {{EndNavigationLinks|MBC_MDWorkspaces|Mantid_Basic_Course}}

.. |sliceviewer.png| image:: /images/sliceviewer.png
   :width: 600px
.. |LineViewer.png| image:: /images/LineViewer.png
   :width: 500px
.. |Peaks_view_outline_unannotated.png| image:: /images/Peaks_view_outline_unannotated.png
   :width: 800px
.. |ReleasePic.png| image:: /images/ReleasePic.png
   :width: 300px
.. |MantidPlot_VSI-v2_Menu.png| image:: /images/MantidPlot_VSI-v2_Menu.png
.. |VSI-MultisliceButton.png| image:: /images/VSI-MultisliceButton.png
.. |VSI-SplatterPlotButton.png| image:: /images/VSI-SplatterPlotButton.png
