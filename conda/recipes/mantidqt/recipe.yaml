schema_version: 1

context:
  # dynamic versioning hasn't been figured out
  version: 1.2.3
  # load_setup_py_data() | get('version', '0.0.0')

package:
  name: mantidqt
  version: ${{ version }}

source:
  path: ../../../

build:
  number: 0

requirements:
  build:
    - ${{ compiler("c") }}
    - if: linux
      then: ${{ stdlib("c") }}
    - ${{ compiler("cxx") }}
    - if: osx
      then: llvm-openmp ${{ llvm_openmp }}
    - if: linux
      then: libgomp
    - ninja ${{ ninja }}
    - cmake ${{ cmake }}
    - git
    - if: build_platform != target_platform
      then: python ${{ python }}
    - if: build_platform != target_platform
      then: cross-python_${{ target_platform }}
    - if: build_platform != target_platform
      then: setuptools
    - if: build_platform != target_platform
      then: numpy ${{ numpy }}
    - if: build_platform != target_platform
      then: pyqt ${{ pyqt }}
    - if: build_platform != target_platform
      then: pyqt5-sip ${{ pyqt5_sip }}
    - if: build_platform != target_platform
      then: pyqtwebengine
    - if: build_platform != target_platform
      then: qt-main ${{ qt_main }}
    - if: build_platform != target_platform
      then: sip
  host:
    - libboost-devel ${{ libboost_devel }}
    - libboost-python-devel ${{ libboost_python_devel }}
    - eigen ${{ eigen }}
    - if: osx or linux
      then: libopenblas ${{ libopenblas }}
    - mantid == ${{ version }}
    - python ${{ python }}
    - pyqt ${{ pyqt }}
    - pyqt5-sip ${{ pyqt5_sip }}
    - pyqtwebengine
    - qscintilla2 ${{ qscintilla2 }}
    - qt-main ${{ qt_main }}
    - qt-webengine
    - setuptools
    - tbb-devel ${{ tbb }}
    - versioningit ${{ versioningit }}
    - if: build_platform != target_platform
      then: numpy ${{ numpy }}
    - if: build_platform != target_platform
      then: sip ${{ sip }}
    - if: linux
      then:
        - libgl-devel
        - vtk ${{ vtk }}
        - xorg-libxxf86vm
        - xorg-libx11
        - xorg-xorgproto
  run:
    - matplotlib ${{ matplotlib }}
    - ${{ pin_compatible("qscintilla2", upper_bound="x.x") }}
    - ${{ pin_compatible("qt-main", upper_bound="5.15.9") }}
    - qtpy ${{ qtpy }}
    - python
    - if: linux
      then: qt-gtk-platformtheme
  run_exports:
    - ${{ pin_subpackage('mantidqt', upper_bound='x.x.x') }}

tests:
  - python:
      imports:
        - mantidqt
        - mantidqt.icons

about:
  license: GPL-3.0-or-later
  summary: Mantid provides a framework that supports high-performance computing and visualisation of materials science data.
  homepage: https://github.com/mantidproject/mantid

extra:
  recipe-maintainers:
    - thomashampson
    - sf1919
    - martyngigg
